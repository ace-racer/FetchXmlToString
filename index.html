<!DOCTYPE html>
<html>
<head>
    <title></title>
	<meta charset="utf-8" />
    <script>
        var fetchToString = fetchToString || {};

        fetchToString.processFetchInput = function () {
            var fetchXmlInput = document.getElementById("input").value;
            var processedStr = fetchToString.convertFetchToString(fetchXmlInput);
            document.getElementById("output").value = processedStr;
        }

        fetchToString.convertFetchToString = function (fetchXml) {
            var retVal = "";
            if (fetchXml) {
                // replace hyphens
                var strValue = fetchXml.replace(new RegExp("-", 'g'), "");

                // replace double quotes with single quotes
                strValue = strValue.replace(new RegExp("\"", 'g'), "'");

                // split by newlines and append 
                var splitStrs = strValue.split("\n");

                for (var itr = 0; itr < splitStrs.length - 1; itr++) {

                    // check the present string is not an empty string before wrapping it in quotes
                    if (splitStrs[itr].length > 0) {
                        retVal += "\"" + splitStrs[itr] + "\"+\n";
                    }
                }

                if (splitStrs.length > 0) {
                    if (splitStrs[splitStrs.length - 1].length > 0) {
                        retVal += "\"" + splitStrs[splitStrs.length - 1] + "\";";
                    }
                }
            }

            return retVal;
        }
    </script>
    <style>
        .inline-div {
            display:inline-block;
        }

        .inline-txtarea {
            resize: none;
            border : 2px solid red;
            height:600px;
        }

    </style>
</head>
<body>            
    <div>
        <p>This web application will help to convert raw Fetch XML strings that are downloaded from the Dynamics CRM interface to strings that can be used in your JS/C# code.</p>
        <p><b>How to use:</b> Give the source Fetch XML string inside the "Raw Fetch XML" area and click on the Convert! button to proceed</p>
    </div>
        <div class="inline-div">
            <p><b>Raw Fetch XML</b></p>
            <textarea id="input" cols="80" rows="15" class="inline-txtarea"></textarea>
        </div>        
        <div class="inline-div">
            <p><b>Processed Fetch XML</b></p>
            <textarea id="output" cols="80" rows="15" class="inline-txtarea"></textarea>
        </div>    
    <div>
        <button value="Convert!" onclick="fetchToString.processFetchInput()">Convert!</button>
    </div>
    <div>
        <p>Developed by Anurag Chatterjee. Contact <a href="mailto:anuragchatterjee92@gmail.com">here</a></p>        
    </div>
</body>
</html>
